<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CCRI Dashboard Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    .menu {
      position: absolute;
      top: 10px;
      left: 10px;
      background: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.3);
      z-index: 1;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>

<div class="menu">
  <label for="indicator-select"><strong>Select Indicator:</strong></label><br/>
  <select id="indicator-select">
    <option value="ccri">CCRI Overall</option>
    <option value="P1_rfl">River Flood</option>
    <option value="P1_cfl">Coastal Flood</option>
    <option value="P1_ts">Tropical Storm</option>
    <option value="P1_hw">Heatwave</option>
    <option value="P1_fr">Fire</option>
    <option value="P1_pm25">Air Pollution (PM2.5)</option>
  </select>
</div>

<div id="map"></div>

<script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
<script>
  const map = new maplibregl.Map({
    container: 'map',
    style: 'https://demotiles.maplibre.org/style.json',
    center: [20, 0],
    zoom: 1.5
  });

  map.on('load', () => {
    // Load GeoJSON from your repo
    map.addSource('countries', {
      type: 'geojson',
      data: 'CCRI_P1_P2_format.geojson'
    });

    // Initial layer
    map.addLayer({
      id: 'country-fill',
      type: 'fill',
      source: 'countries',
      paint: {
        'fill-color': [
          'interpolate', ['linear'], ['to-number', ['get', 'ccri']],
          0, '#eff3ff',
          2, '#bdd7e7',
          4, '#6baed6',
          6, '#2171b5',
          8, '#08306b'
        ],
        'fill-opacity': 0.8
      }
    });

    // Add borders
    map.addLayer({
      id: 'country-borders',
      type: 'line',
      source: 'countries',
      paint: { 'line-color': '#fff', 'line-width': 0.5 }
    });

    // When indicator changes
    document.getElementById('indicator-select').addEventListener('change', (e) => {
      const ind = e.target.value;
      map.setPaintProperty('country-fill', 'fill-color', [
        'interpolate',
        ['linear'],
        ['to-number', ['get', ind]],
        0, '#eff3ff',
        1, '#bdd7e7',
        2, '#6baed6',
        4, '#2171b5',
        8, '#08306b'
      ]);
    });
  });
</script>

</body>
</html>
